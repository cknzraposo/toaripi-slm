# Core model and training components